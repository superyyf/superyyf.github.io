<!doctype html><html lang=zh-cn>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>IPv6 | Play With YYF</title>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=description content="网络层/IPv6">
<meta name=generator content="Hugo 0.92.2">
<meta name=robots content="noindex, nofollow">
<link rel=stylesheet href=/ananke/css/main.min.css>
<meta property="og:title" content="IPv6">
<meta property="og:description" content="网络层/IPv6">
<meta property="og:type" content="article">
<meta property="og:url" content="http://yyf.zone/posts/2021-1-2-ipv6/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-01-02T23:16:36+00:00">
<meta property="article:modified_time" content="2021-01-02T23:16:36+00:00">
<meta itemprop=name content="IPv6">
<meta itemprop=description content="网络层/IPv6"><meta itemprop=datePublished content="2021-01-02T23:16:36+00:00">
<meta itemprop=dateModified content="2021-01-02T23:16:36+00:00">
<meta itemprop=wordCount content="92">
<meta itemprop=keywords content="笔记,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="IPv6">
<meta name=twitter:description content="网络层/IPv6">
</head>
<body class="ma0 avenir bg-near-white">
<header>
<div class=bg-black>
<nav class="pv3 ph3 ph4-ns" role=navigation>
<div class="flex-l justify-between items-center center">
<a href=/ class="f3 fw2 hover-white no-underline white-90 dib">
Play With YYF
</a>
<div class="flex-l items-center">
<div class=ananke-socials>
</div>
</div>
</div>
</nav>
</div>
</header>
<main class=pb7 role=main>
<article class="flex-l flex-wrap justify-between mw8 center ph3">
<header class="mt4 w-100">
<aside class="instapaper_ignoref b helvetica tracked">
POSTS
</aside>
<div id=sharing class="mt3 ananke-socials">
</div>
<h1 class="f1 athelas mt3 mb1">IPv6</h1>
<time class="f6 mv4 dib tracked" datetime=2021-01-02T23:16:36Z>January 2, 2021</time>
</header>
<div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>网络层/IPv6</p>
<h1 id=ipv6>IPv6</h1>
<h2 id=ipv6地址>IPv6地址</h2>
<p>在IPv6中，每个地址占128位，地址空间大于$3.4\times10^{38}$。</p>
<h3 id=冒号十六进制记法>冒号十六进制记法：</h3>
<p>它把每个16位的值用十六进制表示，各值之间用冒号分隔，允许把数字前面的0省略。例如：</p>
<blockquote>
<p>68E6:8C64:FFFF:FFFF:0:1180:960A:FFFF</p>
</blockquote>
<h3 id=零压缩>零压缩：</h3>
<p>一连串连续的零可以用一对冒号取代。在任一地址中只能使用一次零压缩。例如</p>
<blockquote>
<p>FF05:0:0:0:0:0:0:B3</p>
</blockquote>
<p>可压缩为</p>
<blockquote>
<p>FF05::B3</p>
</blockquote>
<h3 id=ipv6的地址分类>IPv6的地址分类</h3>
<table>
<thead>
<tr>
<th>地址类型</th>
<th>二进制前缀</th>
</tr>
</thead>
<tbody>
<tr>
<td>未指明地址</td>
<td>00&mldr;0(128位)，可记为::/128。</td>
</tr>
<tr>
<td>环回地址</td>
<td>00&mldr;1(128位)，可记为::1/128</td>
</tr>
<tr>
<td>多播地址</td>
<td>11111111(8位)，可记为FF00::/8</td>
</tr>
<tr>
<td>本地链路单播地址</td>
<td>1111111010(10位)，可记为FE80::/10</td>
</tr>
<tr>
<td>全球单播地址</td>
<td>（除上述四种外，所有其他的二进制前缀）</td>
</tr>
</tbody>
</table>
<h2 id=ipv6数据报>IPv6数据报</h2>
<p>IPv6数据报由两大部分组成，即<strong>基本首部</strong>(base header)和<strong>有效载荷</strong>(payload)。</p>
<h3 id=基本首部>基本首部</h3>
<p>与IPv4相比，IPv6对首部中的字段进行了如下更改：</p>
<ul>
<li>取消了首部长度字段，因为它的首部长度是固定的(40字节)。</li>
<li>取消了服务类型字段，因为优先级和流标号字段实现了服务类型字段的功能。</li>
<li>取消了总长度字段，改用有效载荷长度字段。</li>
<li>取消了标识、标志和片偏移字段，因为这些功能已包含在分片扩展首部中。</li>
<li>把TTL字段改称为跳数限制字段，作用是一样的。</li>
<li>取消了协议字段，改用下一个首部字段。</li>
<li>取消了检验和字段。</li>
<li>取消了选项字段，而用扩展首部来实现选项功能。</li>
</ul>
<p><img src=/image/jibenshoubu.png alt=基本首部></p>
<p>各字段的作用如下:</p>
<ol>
<li><strong>版本</strong>(version) 占4位。指明协议的版本，对IPv6该字段是6。</li>
<li><strong>通信量类</strong>(traffic class) 占8位。这是为了区分不同数据报的类别或优先级。</li>
<li><strong>流标号</strong>(flow label) 占20位。IPv6的一个新的机制是支持资源预分配，并且允许路由器把每一个数据报与一个给定的资源分配相联系。IPv6提出流(flow)的抽象概念，“流”就是互联网上从特定源点到特定终点(单播或多播)的一系列数据报，而在这个“流”所经过的路径上的路由器都保证指明的服务质量。所有属于同一个流的数据报都具有同样的流标号。因此，流标号对实时音频/视频数据的传送特别有用。关于流标号可参考<a href=https://tools.ietf.org/html/rfc6437>RFC 6437</a>。</li>
<li><strong>有效载荷长度</strong>(payload length) 占16位。它指明IPv6数据报除基本首部以外的字节数。最大值是64KB。</li>
<li><strong>下一个首部</strong>(next header) 占8位。它相当于IPv4的协议字段或可选字段
<ul>
<li>当数据报没有拓展首部时，下一个首部字段的作用和IPv4的协议字段一样。</li>
<li>列表项当出现拓展首部时，下一首部字段的值就标识后面第一个拓展首部的类型。</li>
</ul>
</li>
<li><strong>跳数限制</strong>(hop limit) 占8位。用来防止数据报在网络中无限期地存在。</li>
<li><strong>源地址</strong> 占128位。是数据报的发送端的IP地址。</li>
<li><strong>目的地址</strong> 占128位。是接收端的IP地址。</li>
</ol>
<h3 id=拓展首部>拓展首部</h3>
<p>IPv6把原来IPv4首部中选项的功能都放在拓展首部中，并把拓展首部留给路径两端的源点和终点的主机来处理，而数据报途中的经过的路由器都不处理这些首部（只有一个首部例外，即逐跳选项拓展首部），这样<strong>大大提高了路由器的处理效率</strong>。<br>
在<a href=https://tools.ietf.org/html/rfc2460>RFC 2460</a>中定义了以下六种拓展首部：<br>
(1) <strong>逐跳选项</strong><br>
(2) <strong>路由选项</strong><br>
(3) <strong>分片</strong><br>
(4) <strong>鉴别</strong><br>
(5) <strong>封装安全有效载荷</strong><br>
(6) <strong>目的站选项</strong><br>
每一个拓展首部长度可以不同，但第一个字段都是8位的“下一首部”字段。此字段的值指出了在该拓展首部后面的字段是什么。当使用多个拓展首部时，应按以上的先后顺序出现。<strong>高层首部总是放在最后面</strong>。</p>
<h2 id=从ipv4向ipv6过渡>从IPv4向IPv6过渡</h2>
<ol>
<li><strong>双协议栈</strong>。使一部分主机（或路由器）装有双协议栈：一个IPv4和一个IPv6。这表明它同时具有两种IP地址：一个IPv6地址和一个IPv4地址。</li>
<li><strong>隧道技术</strong>。这种方法的要点是在IPv6数据报要进入IPv4网络时，把IPv6数据报封装为IPv4数据报。</li>
</ol>
<h2 id=icmpv6>ICMPv6</h2>
<p>ICMPv6合并了地址解析协议ARP和网际组管理协议IGMP。<br>
ICMPv6是面向报文的协议，它利用报文来报告差错，获取信息，探测邻站和管理多播通信。<br>
ICMPv6报文：</p>
<ul>
<li>差错报文</li>
<li>信息报文</li>
<li>邻站发现报文（ND协议）</li>
<li>组成员关系报文（MLD协议）</li>
</ul>
<p>参考文献：《计算机网络（第7版）》谢希仁著。</p><ul class=pa0>
<li class="list di">
<a href=/tags/%E7%AC%94%E8%AE%B0 class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">笔记</a>
</li>
</ul>
<div class="mt6 instapaper_ignoref">
</div>
</div>
<aside class="w-30-l mt6-l">
<div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
<p class="f5 b mb3">Related</p>
<ul class="pa0 list">
<li class=mb2>
<a href=/posts/2021-1-2-ipmulticast/>IP多播</a>
</li>
<li class=mb2>
<a href=/posts/2021-1-5-vpnandnat/>虚拟专用网络VPN和网络地址转换NAT</a>
</li>
</ul>
</div>
</aside>
</article>
</main>
<footer class="bg-black bottom-0 w-100 pa3" role=contentinfo>
<div class="flex justify-between">
<a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=http://yyf.zone/>
&copy; Play With YYF 2022
</a>
<div>
<div class=ananke-socials>
</div></div>
</div>
</footer>
</body>
</html>